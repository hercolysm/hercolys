Iptables

# módulos do kernel
lsmod // listar
rmmod // desativar
insmod // levantar

ex: ip_tables (debian) e iptables_nat (fedora)

iptables // protocolos ipv4
ip6tables // protocolos ipv6

# salvar as regras atuais
iptables-save > /bin/rc.firewall

# restaurar regras salvas pelo iptables-save
iptables-restore

# adicionar arquivo na inicialização
// add chamada no fim do arquivo /etc/rc.d/rc.local


iptables -t [tabela] [comando] [ação] -j [alvo]

Tabelas
-t filter (padrão)
-t nat
-t mangle

Chains Padrões
- INPUT
- FORWARD
- OUTPUT

Comandos
-A - append no fim da lista
-I - insere no inicio da lista
-D - deleta da lista
-L - lista
-P - altera politica padrão das chains (ACCEPT, REJECT, DROP)
-F - remove todas as entradas sem alterar a politica padrão
-R - substitui regra já adicionada por outra
-N - cria nova chain
-E - renomeia nova chain
-X - deleta nova chain

Ação
-p - define o protocolo (tcp, icmp, udp)
-i - define a interface de entrada (lo, eth0, eth+)(INPUT, FORWARD)
-o - define a interface de saída (lo, eth0, eth+)(OUTPUT, FORWARD)
-s - define a origem do pacote
-d - define o destino do pacote
-j - define 0 alvo (ACCEPT, DROP, REJECT, LOG)
! - define exclusao
---sport porta de origem
--dport porta de destino